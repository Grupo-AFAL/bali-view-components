<div class="container mx-auto p-6">
  <h1 class="text-2xl font-bold mb-6">Movies</h1>

  <%= render Bali::DataTable::Component.new(
    filter_form: @filter_form,
    url: movies_path,
    pagy: @pagy,
    item_name: 'movies'
  ) do |data_table| %>

    <%# Advanced Filters Panel %>
    <% data_table.with_filters_panel(
      available_attributes: available_filter_attributes,
      filter_groups: filter_groups_from_params,
      search_fields: [:name, :genre],
      search_value: quick_search_value
    ) %>

    <%# Data Table with sortable columns %>
    <% data_table.with_table do %>
      <%= render Bali::Table::Component.new(form: @filter_form) do |table| %>
        <%# Sortable headers - click to sort by column %>
        <% table.with_header(name: "ID", class: "w-12") %>
        <% table.with_header(name: "Name", sort: :name) %>
        <% table.with_header(name: "Genre", sort: :genre) %>
        <% table.with_header(name: "Status", sort: :status) %>
        <% table.with_header(name: "Studio") %>
        <% table.with_header(name: "Indie", sort: :indie) %>
        <% table.with_header(name: "Created", sort: :created_at) %>

        <% @movies.each do |movie| %>
          <% table.with_row do %>
            <td><%= movie.id %></td>
            <td class="font-medium"><%= movie.name %></td>
            <td><span class="badge badge-outline"><%= movie.genre %></span></td>
            <td>
              <span class="badge <%= movie.done? ? 'badge-success' : 'badge-warning' %>">
                <%= movie.status.humanize %>
              </span>
            </td>
            <td class="text-sm text-base-content/70"><%= movie.tenant&.name %></td>
            <td>
              <% if movie.indie %>
                <span class="badge badge-info badge-sm">Yes</span>
              <% else %>
                <span class="badge badge-ghost badge-sm">No</span>
              <% end %>
            </td>
            <td class="text-sm text-base-content/70"><%= movie.created_at.strftime('%Y-%m-%d') %></td>
          <% end %>
        <% end %>

        <% if @movies.empty? %>
          <% table.with_row do %>
            <td colspan="7" class="text-center py-8 text-base-content/50">
              No movies found. Try adjusting your filters.
            </td>
          <% end %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>
</div>
