<%# Movie Form - Showcases: FormBuilder (all field types), Stepper, Card, Button %>

<%# Form Progress Stepper %>
<%= render Bali::Stepper::Component.new(current: 0, color: :primary, class: 'mb-8 w-full') do |stepper| %>
  <% stepper.with_step(title: t('movies.form.stepper.basic_info')) %>
  <% stepper.with_step(title: t('movies.form.stepper.poster')) %>
  <% stepper.with_step(title: t('movies.form.stepper.details')) %>
  <% stepper.with_step(title: t('movies.form.stepper.settings')) %>
<% end %>

<%= form_with model: movie, builder: Bali::FormBuilder, class: 'space-y-8' do |f| %>
  <%# Section 1: Basic Information %>
  <%= render Bali::Card::Component.new(style: :bordered) do %>
    <h3 class="card-title text-lg mb-4">
      <%= render Bali::Icon::Component.new('film', class: 'mr-2') %>
      <%= t('movies.form.basic_info') %>
    </h3>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <%# Text Field %>
      <%= f.text_field_group :name, label: t('movies.form.movie_title'), required: true, placeholder: t('movies.form.enter_title') %>

      <%# Select Field - Genre %>
      <% genres = ['Action', 'Adventure', 'Animation', 'Comedy', 'Drama', 'Horror', 'Sci-Fi', 'Thriller'].map { |g| [g, g] } %>
      <%= f.select_group :genre, genres, { include_blank: t('movies.form.select_genre') }, { label: t('movies.form.genre') } %>

      <%# Select Field - Studio %>
      <% studios = Tenant.order(:name).pluck(:name, :id) %>
      <%= f.select_group :tenant_id, studios, { include_blank: t('movies.form.select_studio') }, { label: t('movies.form.studio') } %>

      <%# Radio Field - Status %>
      <% statuses = Movie.statuses.keys.map { |s| [s.humanize, s] } %>
      <%= f.radio_field_group :status, statuses, { label: t('movies.form.status') }, { orientation: :horizontal, color: :primary } %>
    </div>

    <%# Switch Field - Indie %>
    <div class="mt-4">
      <%= f.switch_field_group :indie, label: t('movies.form.indie_film'), color: :primary %>
    </div>
  <% end %>

  <%# Section 2: Movie Details %>
  <%= render Bali::Card::Component.new(style: :bordered) do %>
    <h3 class="card-title text-lg mb-4">
      <%= render Bali::Icon::Component.new('file-text', class: 'mr-2') %>
      <%= t('movies.form.movie_details') %>
    </h3>

    <%# Text Area %>
    <%= f.text_area_group :synopsis, label: t('movies.form.synopsis'), rows: 4, placeholder: t('movies.form.enter_synopsis'), char_counter: { max: 500 } %>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
      <%# Date Field %>
      <%= f.date_field_group :release_date, label: t('movies.form.release_date') %>

      <%# Number Field (Currency) %>
      <%= f.currency_field_group :budget, label: t('movies.form.budget'), currency: 'USD', placeholder: '0.00' %>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
      <%# Email Field %>
      <%= f.email_field_group :contact_email, label: t('movies.form.contact_email'), placeholder: 'producer@studio.com' %>

      <%# URL Field %>
      <%= f.url_field_group :website_url, label: t('movies.form.website_url'), placeholder: 'https://moviewebsite.com' %>
    </div>
  <% end %>

  <%# Section 3: Media Upload (DirectUpload Demo) %>
  <%= render Bali::Card::Component.new(style: :bordered) do %>
    <h3 class="card-title text-lg mb-4">
      <%= render Bali::Icon::Component.new('image', class: 'mr-2') %>
      <%= t('movies.form.movie_poster') %>
    </h3>

    <%= render Bali::Message::Component.new(color: :info, class: 'mb-4') do %>
      <%= raw t('movies.form.direct_upload_info') %>
    <% end %>

    <%# DirectUpload Component Demo %>
    <%= render Bali::DirectUpload::Component.new(
        form: f,
        method: :poster,
        accept: 'image/*',
        max_file_size: 5,
        drop_zone: true,
        auto_upload: true
      ) %>
  <% end %>

  <%# Section 4: Additional Settings %>
  <%= render Bali::Card::Component.new(style: :bordered) do %>
    <h3 class="card-title text-lg mb-4">
      <%= render Bali::Icon::Component.new('settings', class: 'mr-2') %>
      <%= t('movies.form.additional_settings') %>
    </h3>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <%# Time Zone Select %>
      <%= f.time_zone_select_group :time_zone, nil, { include_blank: t('movies.form.select_timezone') }, { label: t('movies.form.timezone') } %>

      <%# Rating (Number with step) %>
      <%= f.number_field_group :rating, label: t('movies.form.initial_rating'), min: 0, max: 10, step: 0.5, placeholder: '0.0' %>
    </div>

    <%# Info Message %>
    <div class="mt-4">
      <%= render Bali::Message::Component.new(color: :info) do %>
        <%= raw t('movies.form.required_fields_note') %>
      <% end %>
    </div>
  <% end %>

  <%# Form Actions %>
  <div class="flex items-center justify-between pt-4">
    <%= render Bali::Link::Component.new(
      name: t('common.cancel'),
      href: movies_path,
      variant: :ghost
    ) %>

    <div class="flex items-center gap-2">
      <%= render Bali::Button::Component.new(
        name: t('movies.form.save_draft'),
        variant: :ghost,
        type: :submit,
        icon_name: 'save'
      ) %>
      <%= render Bali::Button::Component.new(
        name: movie.persisted? ? t('movies.form.update_movie') : t('movies.form.create_movie'),
        variant: :primary,
        type: :submit,
        icon_name: 'check'
      ) %>
    </div>
  </div>
<% end %>
