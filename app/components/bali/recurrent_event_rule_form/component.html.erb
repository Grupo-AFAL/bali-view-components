<%= tag.div(class: component_classes, data: component_data, disabled: disabled) do %>
  <%= form.hidden_field method, value: value, data: { recurrent_event_rule_target: 'input' },
      disabled: disabled %>

  <div class="flex items-center mb-3">
    <p class="mr-4"><b><%= t('.repeat') %></b></p>

    <%= select_tag :freq, options_for_select(frequency_options),
        class: 'select select-bordered',
        disabled: disabled,
        data: { rrule_attr: 'freq', input_active: true,
        action: 'recurrent-event-rule#toggleFreqCustomizationInputsContainer ' \
                'recurrent-event-rule#toggleIntervalInputContainer ' \
                'recurrent-event-rule#toggleFreqHelperText ' \
                'recurrent-event-rule#setRule' } %>

    <div class="flex items-center" data-recurrent-event-rule-target="intervalInputContainer">
      <p class="mx-4"><b><%= t('.every') %></b></p>

      <%= number_field_tag :interval, 1, min: 1, class: 'input input-bordered w-20', disabled: disabled,
          data: { rrule_attr: 'interval', action: 'recurrent-event-rule#setRule' } %>

      <p class="ml-4">
        <b>
          <span class="hidden" data-recurrent-event-rule-target="freqHelperText" data-rrule-freq="0"></span>
          <span class="hidden" data-recurrent-event-rule-target="freqHelperText" data-rrule-freq="1"><%= t('.month_s') %></span>
          <span class="hidden" data-recurrent-event-rule-target="freqHelperText" data-rrule-freq="2"><%= t('.week_s') %></span>
          <span class="hidden" data-recurrent-event-rule-target="freqHelperText" data-rrule-freq="3"><%= t('.day_s') %></span>
          <span class="hidden" data-recurrent-event-rule-target="freqHelperText" data-rrule-freq="4"><%= t('.hour_s') %></span>
        </b>
      </p>
    </div>
  </div>

  <%# Yearly customization %>
  <div class="pl-5 hidden"
    data-recurrent-event-rule-target="freqCustomizationInputsContainer"
    data-rrule-freq="0"
  >
    <div class="flex items-center mb-2">
      <%= radio_button_tag("#{unique_id}_yearly_on", 1, true, checked: true, class: 'radio mr-2', disabled: disabled,
          data: { action: 'recurrent-event-rule#toggleFreqCustomizationInputs ' \
                          'recurrent-event-rule#setRule' }) %>

      <%= label_tag "#{unique_id}_yearly_on_1", t('.on_option'), disabled: disabled %>

      <div class="flex items-center ml-4"
        data-recurrent-event-rule-target="freqCustomizationInputs"
        data-rrule-freq-option="yearly_on_1"
      >
        <%= select_tag :bymonth, options_for_select(bymonth_options),
            class: 'select select-bordered',
            disabled: disabled,
            data: { rrule_attr: 'bymonth', action: 'recurrent-event-rule#setRule' } %>

        <%= select_tag :bymonthday, options_for_select(bymonthday_options),
            class: 'select select-bordered ml-4',
            disabled: disabled,
            data: { rrule_attr: 'bymonthday', action: 'recurrent-event-rule#setRule' } %>
      </div>
    </div>

    <div class="flex items-center">
      <%= radio_button_tag("#{unique_id}_yearly_on", 2, true, checked: true, class: 'radio mr-2', disabled: disabled,
            data: { action: 'recurrent-event-rule#toggleFreqCustomizationInputs ' \
                            'recurrent-event-rule#setRule' }) %>

      <%= label_tag "#{unique_id}_yearly_on_2", t('.on_the'), disabled: disabled %>

      <div class="flex items-center ml-4"
        data-recurrent-event-rule-target="freqCustomizationInputs"
        data-rrule-freq-option="yearly_on_2"
      >
        <%= select_tag :bysetpos, options_for_select(bysetpos_options),
            class: 'select select-bordered mr-4',
            disabled: disabled,
            data: { rrule_attr: 'bysetpos', action: 'recurrent-event-rule#setRule' } %>

        <%= select_tag :byweekday, options_for_select(byweekday_options),
            class: 'select select-bordered mr-4',
            disabled: disabled,
            data: { rrule_attr: 'byweekday', action: 'recurrent-event-rule#setRule' } %>

        <%= select_tag :bymonth, options_for_select(bymonth_options),
            class: 'select select-bordered',
            disabled: disabled,
            data: { rrule_attr: 'bymonth', action: 'recurrent-event-rule#setRule' } %>
      </div>
    </div>
  </div>

  <%# Monthly customization %>
  <div class="pl-5 hidden"
    data-recurrent-event-rule-target="freqCustomizationInputsContainer"
    data-rrule-freq="1"
  >
    <div class="flex items-center mb-2">
      <%= radio_button_tag("#{unique_id}_monthly_on", 1, true, checked: true, class: 'radio mr-2', disabled: disabled,
          data: { action: 'recurrent-event-rule#toggleFreqCustomizationInputs ' \
                          'recurrent-event-rule#setRule' }) %>

      <%= label_tag "#{unique_id}_monthly_on_1", t('.on_day'), disabled: disabled %>

      <div class="flex items-center ml-4"
        data-recurrent-event-rule-target="freqCustomizationInputs"
        data-rrule-freq-option="monthly_on_1"
      >
        <%= select_tag :bymonthday, options_for_select(bymonthday_options),
            class: 'select select-bordered',
            disabled: disabled,
            data: { rrule_attr: 'bymonthday', action: 'recurrent-event-rule#setRule' } %>
      </div>
    </div>

    <div class="flex items-center">
      <%= radio_button_tag("#{unique_id}_monthly_on", 2, true, checked: true, class: 'radio mr-2', disabled: disabled,
          data: { action: 'recurrent-event-rule#toggleFreqCustomizationInputs ' \
                          'recurrent-event-rule#setRule' }) %>

      <%= label_tag "#{unique_id}_monthly_on_2", t('.on_the'), disabled: disabled %>

      <div class="flex items-center ml-4"
        data-recurrent-event-rule-target="freqCustomizationInputs"
        data-rrule-freq-option="monthly_on_2"
      >
        <%= select_tag :bysetpos, options_for_select(bysetpos_options),
            class: 'select select-bordered mr-4',
            disabled: disabled,
            data: { rrule_attr: 'bysetpos', action: 'recurrent-event-rule#setRule' } %>

        <%= select_tag :byweekday, options_for_select(byweekday_options),
            class: 'select select-bordered',
            disabled: disabled,
            data: { rrule_attr: 'byweekday', action: 'recurrent-event-rule#setRule' } %>
      </div>
    </div>
  </div>

  <%# Weekly customization (day checkboxes) %>
  <div class="pl-5 hidden"
    data-recurrent-event-rule-target="freqCustomizationInputsContainer"
    data-rrule-freq="2"
  >
    <%= radio_button_tag "#{unique_id}_weekly", 1, false, checked: true, class: 'hidden' %>
    <div class="weekday-checkboxes-container"
      data-recurrent-event-rule-target="freqCustomizationInputs"
      data-rrule-freq-option="weekly_1"
    >
      <% I18n.t('date.day_names').each_with_index do |day, index| %>
        <% day_value = index.zero? ? 6 : index - 1 %>
        <%= check_box_tag "byweekday_#{unique_id}_[]", day_value, false, id: "byweekday_#{unique_id}_#{day_value}", disabled: disabled,
            class: 'peer hidden',
            data: { rrule_attr: 'byweekday', action: 'recurrent-event-rule#setRule' } %>
        <%= label_tag "byweekday_#{unique_id}_#{day_value}", day.first, disabled: disabled,
            class: 'flex items-center justify-center min-w-8 min-h-8 w-8 h-8 rounded-full bg-base-300 font-bold cursor-pointer peer-checked:bg-primary peer-checked:text-primary-content' %>
      <% end %>
    </div>
  </div>

  <%# Daily/Hourly customization (empty placeholder) %>
  <div class="pl-5 hidden"
    data-recurrent-event-rule-target="freqCustomizationInputsContainer"
    data-rrule-freq="3,4"
  ></div>

  <%# End method selection %>
  <div class="<%= class_names('flex items-center mt-5', 'hidden': skip_end_method) %>">
    <p class="mr-4"><b><%= t('.end') %></b></p>

    <%= select_tag :end, options_for_select(ending_options),
        class: 'select select-bordered',
        disabled: disabled,
        data: {
          recurrent_event_rule_target: 'endMethodSelect',
          action: 'recurrent-event-rule#toggleEndCustomizationInputsContainer ' \
                  'recurrent-event-rule#setRule'
        } %>

    <div class="hidden ml-4" data-recurrent-event-rule-target="endCustomizationInputsContainer" data-end-value="">
    </div>

    <div class="hidden flex items-center ml-4" data-recurrent-event-rule-target="endCustomizationInputsContainer" data-end-value="count">
      <%= number_field_tag :count, 1, min: 1, class: 'input input-bordered w-20', disabled: disabled,
          data: { rrule_attr: 'count', action: 'recurrent-event-rule#setRule' } %>
      <p class="ml-4"><b><%= t('.ocurrence_s') %></b></p>
    </div>

    <div class="hidden ml-4" data-recurrent-event-rule-target="endCustomizationInputsContainer" data-end-value="until">
      <%= date_field_tag :until, 6.months.from_now.to_date, class: 'input input-bordered', disabled: disabled,
          data: { rrule_attr: 'until', recurrent_event_rule_target: 'untilInput', action: 'recurrent-event-rule#setRule' } %>
    </div>
  </div>
<% end %>
